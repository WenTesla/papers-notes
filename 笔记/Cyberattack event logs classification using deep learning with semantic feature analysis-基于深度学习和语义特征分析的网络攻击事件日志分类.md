# Cyberattack event logs classification using deep learning with semantic feature analysis-基于深度学习和语义特征分析的网络攻击事件日志分类

## 摘要

事件日志通过检测潜在的恶意网络活动和防止数据丢失或被盗，在网络安全中发挥着至关重要的作用。以前的工作并没有高度重视日志消息及其对安全漏洞预测和入侵检测的影响。**本文介绍了一种新的日志消息分析方法，该方法应用于从各种web来源收集的事件日志数据集**。事件日志消息根据事件和攻击类型进行分析和分类，并使用可解释的AI强调其关键数据的价值。该研究旨在通过识别可疑事件来增强入侵检测，并将性能下降降至最低。在这方面，提出了一种新的语义矢量化框架，利用深度学习架构开发语义区分日志特征，为事件日志消息提供令人信服的解释和分类。使用BERT深度嵌入作为预测模型的基线，可以可视化和解释日志消息语义特征的表述。考虑到攻击类型、事件类型和零射击日志，设置并广泛地进行了几个经验场景来评估事件日志分类器的性能。实验结果表明，所提出的事件日志分类器优于最先进的机器学习模型，达到了99.27%的召回率和99.29%的精度。这突出了模型通过检测尽可能多的可疑事件来准确识别特定类型事件的能力，同时将错误分类率降至最低。

## 介绍

我们的研究使用来自**不同操作系统和流量类型的各种数据源来根据攻击和事件类型对事件进行分类**。与传统方法不同，我们的方法论将语义特征优先于非语义特征，通过评估模型仅从消息文本中识别事件或攻击类型的能力，使分类过程更具挑战性

因此，本研究提出了一种用于更高级别数据分类的新方法，强调**事件消息的语义内容**在检测入侵中的重要性。

这是通过利用从各种源环境收集的不同日志事件数据集来实现的，这些数据集经过系统的处理和分析，旨在检测攻击。所提出的方法为分类程序提供了详细的信息，有助于攻击类型的检测。采用不同的可解释人工智能技术来评估消息文本中日志词的影响，以预测攻击类型。

随后，建立了一个矢量化框架来评估分类器学习特定决策模式的能力，使其能够仔细检查消息的语义内容以预测攻击类型

### 贡献

1.引入一种新颖的基于日志消息中嵌入的语义学的事件日志分类方法。该方法在按事件和攻击类型分类的新事件日志集合上得到验证。

2.提出基于深度学习方法的语义向量化框架，作为开发语义向量的基础，以提供事件日志消息的可靠分析，以及利用BERT功能可视化消息语义特征的属性。

3.使用机器学习算法对标记的日志消息提供基于XAI的深刻分析，包括混合深度架构，带有GRU的CNN。

## 相关工作

![img](https://oss.xljsci.com//literature/132774229/page0/1735954642912.png)

- 日志分类
- 攻击检测
- 攻击数据集

### 总结

与早期研究相比，本文提出了一种新的网络攻击检测框架，并**创建了来自多个源环境的日志事件数据集**。数据分析过程中的更多数据源。事件日志从Window和Linux操作系统收集，以提供具有九种攻击类型的各种事件。事件日志根据其消息进行分类，这是研究主体中缺失的功能。此外，通过根据事件类型标记每个事件，这项工作从文本消息中确定攻击类型，这有助于精确确定攻击类型。在这项研究中，我们不仅探索了分类过程，还探索了每条消息如何有助于确定攻击类型。 我们的方法涉及利用可解释的人工智能技术来提高识别系统对特定攻击类型的脆弱性的决策过程的透明度和理解力。最后，提出的数据集用于评估各种传统和深度学习算法在检测网络攻击方面的效率。

## 数据集

#### TLDCDE

网络防御演习

#### AIT

适用于分析入侵检测系统的合成日志事件，

#### MACCDC

在大学和大学生之间的竞争测试中收集

#### 零日攻击



#### 数据标注

AIT数据集已经标记，但MACCDC数据集和流量/日志数据集需要标记

在初始标记阶段，根据数据集提供的时间信息，在识别的攻击时间间隔内生成的所有日志事件都被归类为可疑或非可疑。虽然由于能够从攻击场景描述中导出异常时间窗口，这种标记方法很简单，但它的缺点是也**将攻击期间发生的非可疑事件归类为可疑事件**

然而，这种方法的权衡是错误分类的显着增加，因为代码脚本可能难以标记看不见的数据。不属于可用数据集的样本可能无法正确标记。

### 基于攻击类型的标签

![img](https://cdn.xljsci.com/literature/132774229/page5/mw0m1f.png)

![img](https://cdn.xljsci.com/literature/132774229/page5/5g715g.png)分为九类

- 网络侦察攻击
- 特权升级攻击（水平攻击与垂直攻击）
- 暴力攻击
- 数据泄露攻击
- 令牌攻击
- 拒绝服务攻击DDOS
- 基于凭据的攻击
- 网络钓鱼攻击
- web攻击

标注之后统计的数据

![攻击类型统计表](https://cdn.xljsci.com/literature/132774229/page6/nrr42h.png)

![事件表](https://cdn.xljsci.com/literature/132774229/page7/iqk6qm.png)

![Windows、Linux和网络流量的日志格式摘要。](https://cdn.xljsci.com/literature/132774229/page7/u7rsnd.png)



## 方法

分析和评估收集的数据集的方法论

![框架](https://cdn.xljsci.com/literature/132774229/page8/yfm388.png)

### 数据预处理

1. 格式转变：Json->TxT->XML->CSV
2. 去重
3. 根据事件类型对数据进行分类，事件被重新分类为可疑和非可疑类别。最后，通过**删除所有非可疑事件来过滤数据集**，以开始基于攻击类型的新类型分类。

### 特征提取

![img](https://cdn.xljsci.com/literature/132774229/page8/s7gzov.png)

### 数据拆分

使用了70%的训练集、10%的验证数据集和20%的测试数据集

### ML DL

这项工作使用了传统的机器学习和深度学习算法。对于传统的机器学习进行性能评估。应用了七种标准算法：多层感知器（MLP）、逻辑回归（LR）、随机森林（RF）、支持向量分类器（SVC）、极端梯度提升（XGBoost）、随机梯度下降（SGD）和朴素贝叶斯（NB）。

对于深度学习模型，我们评估了基于BERT的模型、卷积神经网络（CNN）、双向循环神经网络（Bi-RNN）、长短期记忆网络（LSTM）、双向长短期记忆网络（LSTM）、双向门控循环单元（Bi-GRU）以及由CNN层和GRU层组成的混合模型。

### 语义特征分析

我们使用LIME（Ribeiro et al.，2016）和Captum（Kokhlikyan et  al.，2019）来解释事件消息中的每个单词，解释其对最终决策的影响，并在预测数据中发现偏差和错误决策。一项彻底的研究表明，这两种方法在解释特征方面非常有效，并且可以证明监督学习模型所做的任何类型的预测是合理的（Gohel et al.，2021）。



## 实验

### 结果

这项工作进行了三种类型的实验：

**第一种基于攻击类型数据集**

**第二种基于事件类型数据集**

**最后一种实验基于零样本数据集。**



### **用于攻击检测的模型优化**

![img](https://oss.xljsci.com//literature/132774229/page0/1735972531954.png)

![ML和DL的结果](https://cdn.xljsci.com/literature/132774229/page10/9qritx.png)

![攻击类型的实验结果总结](https://cdn.xljsci.com/literature/132774229/page10/oql3we.png)

![事件类型的实验结果摘要](https://cdn.xljsci.com/literature/132774229/page10/bpf89e.png)

![DL模型的训练和测试时间复杂度总结](https://cdn.xljsci.com/literature/132774229/page10/dskt27.png)

### 语义消息解释

本研究使用LIME工具通过创建人类可读的解释来解释XG-Boost模型预测

>  XGBoost（eXtreme Gradient Boosting）[极致梯度提升](https://zhida.zhihu.com/search?content_id=124133621&content_type=Article&match_order=1&q=极致梯度提升&zhida_source=entity)，是一种基于GBDT的算法或者说工程实现。 

**如下图所示，对数据中每个类标签的特定实例的局部解释，以识别在制定给定预测时最重要的输入数据特征。**

![img](https://cdn.xljsci.com/literature/132774229/page11/j9p1o7.png)



图6描绘了BERT预测的所有层的令牌属性热图。值得注意的是，在BFA类中，“身份验证”一词的属性从第一层增加到第九层。这种意义在最后三层逐渐减弱。另一方面，DLA中的“凭据”一词从第一层到最后一层的归因级别不断增加。

![img](https://oss.xljsci.com//literature/132774229/page0/1735974621330.png)